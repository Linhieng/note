## 🍕 mongoose 创建模型时允许的类型

来自:
- [中文](https://mongoosejs.com/docs/schematypes.html)
- [English](http://mongoosejs.net/docs/schematypes.html)

合法的  SchemaTypes:

- `String` 任意长度字符串
- `Number` 任意数字, 包括普通小数>
- `Date` 日期
- `Buffer` 字节流(文件?)
- `Boolean` 布尔值
- `Mixed` 混合类型
- `ObjectId` 唯一值, 是一个对象, 但可转换为24位的字符串
- `Array` 数组
- `Decimal128` 精确小数(金额)?
- `Map` 图?
- `Schema` 其他 Schema?

## 🍕 创建模型

`new mongoose.Schema({})` 返回一个 `Schema` 对象

例子:
```js
const schema = new Schema({
  name:    String,
  binary:  Buffer,
  living:  Boolean,
  updated: { type: Date, default: Date.now }, // 指定默认值
  age:     { type: Number, min: 18, max: 65 }, // 限制数值范围
  mixed:   Schema.Types.Mixed,
  _someId: Schema.Types.ObjectId,
  decimal: Schema.Types.Decimal128,
  array: [], // 数组类型
  ofString: [String],
  ofNumber: [Number],
  ofDates: [Date],
  ofBuffer: [Buffer],
  ofBoolean: [Boolean],
  ofMixed: [Schema.Types.Mixed],
  ofObjectId: [Schema.Types.ObjectId],
  ofArrays: [[]],
  ofArrayOfNumbers: [[Number]],
  nested: { // 对象类型
    stuff: { type: String, lowercase: true, trim: true }
  },
  map: Map,
  mapOfString: {
    type: Map,
    of: String
  }
})

// example use

const Thing = mongoose.model('Thing', schema);

const m = new Thing;
m.name = 'Statue of Liberty';
m.age = 125;
m.updated = new Date;
m.binary = Buffer.alloc(0);
m.living = false;
m.mixed = { any: { thing: 'i want' } };
m.markModified('mixed');
m._someId = new mongoose.Types.ObjectId;
m.array.push(1);
m.ofString.push("strings!");
m.ofNumber.unshift(1,2,3,4);
m.ofDates.addToSet(new Date);
m.ofBuffer.pop();
m.ofMixed = [1, [], 'three', { four: 5 }];
m.nested.stuff = 'good';
m.map = new Map([['key', 'value']]);
m.save(callback);
```

## 🍕 js 创建模型

最基本步骤是这样的:

```js
const aSchema = new mongoose.Schema({}) // 创建一个模型 Schema
const aModel = mongoose.model('names', aSchema) // 创建该模型的构造函数
const aDocument = new aModel({}) // 使用构造函数生成数据
aDocument.save() // 将数据保存到数据库中
```

## 🍕 ts 创建模型

最基本的步骤是这样的:

```js
interface I = {} // 通常先使用接口定义好结构
const aSchema = new mongoose.Schema<I>({}) // 在 js 的基础上使用泛型, 同时要确保定义的结构和接口的一致
const aModel = mongoose.model<I>('names', aSchema) // 在 js 在基础上使用了泛型
const aDocument = new aModel({}) // 和 js 一致
aDocument.save()
```